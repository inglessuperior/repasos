<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Repaso Módulo 8</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ESTILOS IDÉNTICOS A M5 */
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            font-size: 16px;
            line-height: 1.6;
            color: #333;
            margin: 0;
            padding: 20px;
            background-color: #ffffff;
        }
        .titulo1 {
            font-size: 3rem;
            font-weight: 700;
            color: #2563eb;
            line-height: 1.25;
        }
        .titulo2 {
            font-size: 1.875rem;
            font-weight: 700;
            color: #1f2937;
        }
        .subtitulo {
            font-size: 1.3rem;
            font-weight: 700;
            color: #374151;
        }
        .formula {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            padding: 12px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            text-align: center;
            font-weight: 500;
            margin-bottom: 16px;
        }
        .question-group {
            margin-bottom: 25px;
            padding: 15px;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            background-color: #f8f8f8;
        }
        .result-container {
            margin-top: 10px;
            padding: 8px 12px;
            border-radius: 4px;
            font-weight: 600;
            line-height: 1.4;
            font-size: 0.95rem;
        }
        .hidden-initial {
            display: none;
            padding: 0;
            margin: 0;
        }
        .correct {
            background-color: #d1e7dd;
            color: #0f5132;
            border: 1px solid #badbcc;
        }
        .incorrect {
            background-color: #f8d7da;
            color: #842029;
            border: 1px solid #f5c2c7;
        }
        .check-button {
            padding: 12px 25px;
            background-color: #2563eb;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            margin-top: 30px;
            font-weight: 600;
            display: block;
            transition: background-color 0.3s;
        }
        .check-button:hover {
            background-color: #1d4ed8;
        }
        .pdf-button {
            padding: 12px 25px;
            background-color: #10b981;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            margin-top: 15px;
            font-weight: 600;
            display: none;
            transition: background-color 0.3s;
        }
        .pdf-button:hover {
            background-color: #059669;
        }
        input[type="radio"] {
            margin-right: 8px;
        }
        label {
            display: block;
            padding: 4px 0;
            cursor: pointer;
        }
        #finalScore {
            min-height: 100px;
        }
        #finalScore p {
            margin: 0;
        }
        .mb-4 {
            margin-bottom: 1rem;
        }
        .select-dropdown {
            padding: 8px 12px;
            border: 1px solid #ccc;
            border-radius: 4px;
            background-color: white;
            font-size: 1rem;
            width: 100%;
            max-width: 300px;
            cursor: pointer;
        }
        .order-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            padding: 10px;
            background-color: #e5e7eb;
            border-radius: 6px;
            min-height: 50px;
        }
        .drag-pool {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            padding: 10px;
            background-color: #f1f5f9;
            border-radius: 6px;
            margin-top: 10px;
        }
        .drop-blank {
            display: inline-block;
            min-width: 60px;
            min-height: 30px;
            border-bottom: 2px solid #3b82f6;
            padding: 2px 5px;
            margin: 0 4px;
            text-align: center;
            color: #1f2937;
            background-color: #ffffff;
            border-radius: 3px 3px 0 0;
            cursor: pointer;
            font-weight: 600;
        }
        .drop-blank.drag-over {
            background-color: #bfdbfe;
            border-color: #1d4ed8;
        }
        .drop-blank-filled {
            color: #1f2937;
            font-weight: 700;
        }
        .order-word {
            padding: 6px 12px;
            background-color: #4f46e5;
            color: white;
            border-radius: 4px;
            cursor: grab;
            font-weight: 600;
            transition: background-color 0.2s, transform 0.1s;
            user-select: none;
        }
        .order-word:hover {
            background-color: #4338ca;
        }
        .order-word.dragging {
            opacity: 0.5;
            border: 2px dashed #f59e0b;
        }
        .order-container.drag-over {
            border: 2px dashed #f59e0b;
            background-color: #fee2e2;
        }
        @media (max-width: 768px) {
            .titulo1 { font-size: 2.5rem; }
            .titulo2 { font-size: 1.5rem; }
            .subtitulo { font-size: 1.1rem; }
        }
        @media print {
            body {
                padding: 0;
                margin: 0;
                max-width: 800px;
                margin: 0 auto;
            }
            .check-button,
            .pdf-button {
                display: none !important;
            }
            #quizForm,
            main,
            .question-group,
            .titulo2,
            .subtitulo,
            .flex.flex-col.items-center {
                display: block !important;
            }
            .question-group {
                border: none !important;
                background-color: white !important;
                padding: 5px 0 !important;
                margin-bottom: 10px !important;
            }
            #finalScore {
                display: flex !important;
                margin: 30px auto;
                max-width: 600px;
                border: 2px solid #000;
                background-color: white !important;
            }
            .select-dropdown {
                border: 1px solid #000 !important;
                background-color: #eee !important;
                max-width: none !important;
            }
            input[type="radio"]:checked + label {
                font-weight: 700;
            }
            .result-container {
                display: block !important;
                border: 1px solid #ccc;
                padding: 4px 8px;
                margin-bottom: 8px;
                font-size: 0.9rem;
            }
            .correct {
                background-color: #c8e6c9 !important;
                color: #000 !important;
                border: 1px solid #81c784 !important;
            }
            .incorrect {
                background-color: #ffcdd2 !important;
                color: #000 !important;
                border: 1px solid #e57373 !important;
            }
            .order-container, .drag-pool {
                display: block !important;
                background-color: #f8f8f8 !important;
            }
            .order-word {
                color: #333 !important;
                background-color: #ccc !important;
                margin-right: 5px;
                display: inline-block;
                border: 1px solid #aaa;
                cursor: default !important;
            }
            .drop-blank {
                border-color: #000 !important;
                color: #333 !important;
                background-color: #e0e0e0 !important;
                font-weight: 700 !important;
            }
        }
    </style>
</head>
<body>
    <header class="max-w-4xl mx-auto text-center" id="header-print">
        <img src="https://i.imgur.com/7BHucwa.png" class="imagen1" alt="Logo de Inglés Superior" style="display: block; margin: 1rem auto;">
        <p class="formula mx-auto p-0 text-sm" style="width: fit-content; min-width: 150px; color: #1f2937; border-color: #d1d5db;">MÓDULO: 8</p>
        <h1 class="titulo1 mt-2 mb-8">Repaso General</h1>
        <p class="text-lg text-gray-600 mb-10">Instrucciones: Lee cada pregunta con atención y responde correctamente.</p>
    </header>

    <main class="max-w-4xl mx-auto mt-10">
        <form id="quizForm" onsubmit="return false;">
            <hr class="border-t border-gray-300 my-4">

            <!-- SECCIÓN I: SEGUNDO CONDICIONAL - 10 PREGUNTAS -->
            <h2 class="titulo2 my-6">Sección I: Segundo condicional</h2>
            
            <div class="question-group">
                <p class="mb-4">1. If I ______ (win) the lottery, I ______ (travel) around the world.</p>
                <label><input type="radio" name="q1" value="A"> had won / would have traveled</label>
                <label><input type="radio" name="q1" value="B"> win / will travel</label>
                <label><input type="radio" name="q1" value="C"> won / would travel</label>
                <div id="result1" class="result-container hidden-initial"></div>
            </div>

            <div class="question-group">
                <p class="mb-4">2. What ______ you ______ (do) if you ______ (have) more free time?</p>
                <label><input type="radio" name="q2" value="A"> would / did / would have</label>
                <label><input type="radio" name="q2" value="B"> would / do / had</label>
                <label><input type="radio" name="q2" value="C"> will / do / have</label>
                <div id="result2" class="result-container hidden-initial"></div>
            </div>

            <div class="question-group">
                <p class="mb-4">3. If she ______ (be) the CEO, she ______ (change) the company policies.</p>
                <label><input type="radio" name="q3" value="A"> is / would change</label>
                <label><input type="radio" name="q3" value="B"> were / would change</label>
                <label><input type="radio" name="q3" value="C"> was / will change</label>
                <div id="result3" class="result-container hidden-initial"></div>
            </div>

            <div class="question-group">
                <p class="mb-4">4. If they ______ (not / have) to work tomorrow, they ______ (come) to the party.</p>
                <label><input type="radio" name="q4" value="A"> didn't have / would come</label>
                <label><input type="radio" name="q4" value="B"> don't have / will come</label>
                <label><input type="radio" name="q4" value="C"> hadn't / would have come</label>
                <div id="result4" class="result-container hidden-initial"></div>
            </div>

            <!-- Q5: DROP-DOWN -->
            <div class="question-group">
                <p class="mb-4">5. I ______ (buy) a new car if I had enough money.</p>
                <select name="q5" class="select-dropdown">
                    <option value="" selected disabled>-- Seleccionar conjugación --</option>
                    <option value="A">would bought</option>
                    <option value="B">will buy</option>
                    <option value="C">would buy</option>
                </select>
                <div id="result5" class="result-container hidden-initial"></div>
            </div>

            <div class="question-group">
                <p class="mb-4">6. If I ______ you, I ______ (apologize) immediately.</p>
                <label><input type="radio" name="q6" value="A"> am / apologize</label>
                <label><input type="radio" name="q6" value="B"> were / would apologize</label>
                <label><input type="radio" name="q6" value="C"> was / will apologize</label>
                <div id="result6" class="result-container hidden-initial"></div>
            </div>

            <!-- Q7: FILL-IN-THE-BLANK DRAG-AND-DROP (CONDICIONAL) -->
            <div class="question-group">
                <p class="mb-4">7. Arrastra las palabras para formar una oración en segundo condicional:</p>
                <p class="mb-4">
                    <span id="q7-blank-1" class="drop-blank" data-blank-index="1" data-answer=""></span> 
                    I 
                    <span id="q7-blank-2" class="drop-blank" data-blank-index="2" data-answer=""></span> 
                    a better job, I 
                    <span id="q7-blank-3" class="drop-blank" data-blank-index="3" data-answer=""></span> 
                    be happier.
                </p>
                <div id="q7-pool" class="drag-pool">
                    <span class="order-word" data-word="have" draggable="true">have</span>
                    <span class="order-word" data-word="had" draggable="true">had</span>
                    <span class="order-word" data-word="be" draggable="true">be</span>
                    <span class="order-word" data-word="would" draggable="true">would</span>
                    <span class="order-word" data-word="will" draggable="true">will</span>
                    <span class="order-word" data-word="If" draggable="true">If</span>
                </div>
                <input type="hidden" name="q7_order" id="q7_order" value="">
                <div id="result7" class="result-container hidden-initial"></div>
            </div>

            <div class="question-group">
                <p class="mb-4">8. Which sentence describes an imaginary or unlikely situation in the present?</p>
                <label><input type="radio" name="q8" value="A"> If I had a million dollars, I'd buy a house.</label>
                <label><input type="radio" name="q8" value="B"> If it rains, we'll stay home.</label>
                <label><input type="radio" name="q8" value="C"> If I had studied, I would have passed.</label>
                <div id="result8" class="result-container hidden-initial"></div>
            </div>

            <!-- Q9: ORDENAMIENTO -->
            <div class="question-group">
                <p class="mb-4">9. Ordena las palabras para formar una pregunta en segundo condicional:</p>
                <div id="q9-words" class="order-container">
                    <span class="order-word" data-word="would" draggable="true">would</span>
                    <span class="order-word" data-word="you" draggable="true">you</span>
                    <span class="order-word" data-word="What" draggable="true">What</span>
                    <span class="order-word" data-word="do" draggable="true">do</span>
                    <span class="order-word" data-word="president" draggable="true">president</span>
                    <span class="order-word" data-word="were" draggable="true">were</span>
                    <span class="order-word" data-word="you" draggable="true">you</span>
                    <span class="order-word" data-word="?" draggable="true">?</span>
                    <span class="order-word" data-word="if" draggable="true">if</span>
                </div>
                <input type="hidden" name="q9_order" id="q9_order" value="">
                <div id="result9" class="result-container hidden-initial"></div>
            </div>

            <div class="question-group">
                <p class="mb-4">10. If I ______ (be) you, I ______ (not / go) to that meeting alone.</p>
                <label><input type="radio" name="q10" value="A"> were / wouldn't go</label>
                <label><input type="radio" name="q10" value="B"> was / wouldn't go</label>
                <label><input type="radio" name="q10" value="C"> am / won't go</label>
                <div id="result10" class="result-container hidden-initial"></div>
            </div>

            <hr class="border-t border-gray-300 my-10">

            <!-- SECCIÓN II: VERBOS MODALES AVANZADOS Y EXPRESIONES - 12 PREGUNTAS -->
            <h2 class="titulo2 my-6 mt-10">Sección II: Modales avanzados y expresiones</h2>

            <p class="subtitulo mb-6">A. Might, could, may, ought to. Elige la opción correcta.</p>

            <div class="question-group">
                <p class="mb-4">11. Take an umbrella. It ______ rain later.</p>
                <label><input type="radio" name="q11" value="A"> will</label>
                <label><input type="radio" name="q11" value="B"> might</label>
                <label><input type="radio" name="q11" value="C"> must</label>
                <div id="result11" class="result-container hidden-initial"></div>
            </div>

            <div class="question-group">
                <p class="mb-4">12. You ______ to see a doctor about that cough.</p>
                <label><input type="radio" name="q12" value="A"> must</label>
                <label><input type="radio" name="q12" value="B"> should</label>
                <label><input type="radio" name="q12" value="C"> ought</label>
                <div id="result12" class="result-container hidden-initial"></div>
            </div>

            <!-- Q13: DROP-DOWN -->
            <div class="question-group">
                <p class="mb-4">13. She ______ be at home; I saw her car in the driveway.</p>
                <select name="q13" class="select-dropdown">
                    <option value="" selected disabled>-- Seleccionar modal --</option>
                    <option value="A">must</option>
                    <option value="B">might</option>
                    <option value="C">could</option>
                </select>
                <div id="result13" class="result-container hidden-initial"></div>
            </div>

            <div class="question-group">
                <p class="mb-4">14. This ______ be the solution to our problem. I'm not sure.</p>
                <label><input type="radio" name="q14" value="A"> must</label>
                <label><input type="radio" name="q14" value="B"> could</label>
                <label><input type="radio" name="q14" value="C"> will</label>
                <div id="result14" class="result-container hidden-initial"></div>
            </div>

            <p class="subtitulo mb-6 mt-8">B. Preferencias y sugerencias: would rather, had better, prefer.</p>

            <div class="question-group">
                <p class="mb-4">15. I ______ stay home than go out tonight.</p>
                <label><input type="radio" name="q15" value="A"> prefer to</label>
                <label><input type="radio" name="q15" value="B"> would rather</label>
                <label><input type="radio" name="q15" value="C"> had better</label>
                <div id="result15" class="result-container hidden-initial"></div>
            </div>

            <div class="question-group">
                <p class="mb-4">16. You ______ finish that report today. The deadline is tomorrow.</p>
                <label><input type="radio" name="q16" value="A"> would rather</label>
                <label><input type="radio" name="q16" value="B"> might</label>
                <label><input type="radio" name="q16" value="C"> had better</label>
                <div id="result16" class="result-container hidden-initial"></div>
            </div>

            <!-- Q17: FILL-IN-THE-BLANK DRAG-AND-DROP (PREFER) -->
            <div class="question-group">
                <p class="mb-4">17. Arrastra las palabras para completar la preferencia:</p>
                <p class="mb-4">I 
                    <span id="q17-blank-1" class="drop-blank" data-blank-index="1" data-answer=""></span> 
                    coffee 
                    <span id="q17-blank-2" class="drop-blank" data-blank-index="2" data-answer=""></span> 
                    tea.
                </p>
                <div id="q17-pool" class="drag-pool">
                    <span class="order-word" data-word="prefer" draggable="true">prefer</span>
                    <span class="order-word" data-word="would rather" draggable="true">would rather</span>
                    <span class="order-word" data-word="had better" draggable="true">had better</span>
                    <span class="order-word" data-word="to" draggable="true">to</span>
                    <span class="order-word" data-word="than" draggable="true">than</span>
                </div>
                <input type="hidden" name="q17_order" id="q17_order" value="">
                <div id="result17" class="result-container hidden-initial"></div>
            </div>

            <div class="question-group">
                <p class="mb-4">18. We ______ to work remotely rather than commute.</p>
                <label><input type="radio" name="q18" value="A"> prefer</label>
                <label><input type="radio" name="q18" value="B"> had better</label>
                <label><input type="radio" name="q18" value="C"> would rather</label>
                <div id="result18" class="result-container hidden-initial"></div>
            </div>

            <div class="question-group">
                <p class="mb-4">19. Which sentence expresses a strong recommendation?</p>
                <label><input type="radio" name="q19" value="A"> You might want to check your email.</label>
                <label><input type="radio" name="q19" value="B"> You had better apologize to her.</label>
                <label><input type="radio" name="q19" value="C"> You could try calling again.</label>
                <div id="result19" class="result-container hidden-initial"></div>
            </div>

            <div class="question-group">
                <p class="mb-4">20. She ______ not attend the meeting if she's sick.</p>
                <label><input type="radio" name="q20" value="A"> had better</label>
                <label><input type="radio" name="q20" value="B"> might</label>
                <label><input type="radio" name="q20" value="C"> ought</label>
                <div id="result20" class="result-container hidden-initial"></div>
            </div>

            <!-- Q21: ORDENAMIENTO (WOULD RATHER) -->
            <div class="question-group">
                <p class="mb-4">21. Ordena las palabras para expresar preferencia:</p>
                <div id="q21-words" class="order-container">
                    <span class="order-word" data-word="rather" draggable="true">rather</span>
                    <span class="order-word" data-word="I" draggable="true">I</span>
                    <span class="order-word" data-word="dinner" draggable="true">dinner</span>
                    <span class="order-word" data-word="cook" draggable="true">cook</span>
                    <span class="order-word" data-word="would" draggable="true">would</span>
                    <span class="order-word" data-word="home" draggable="true">home</span>
                    <span class="order-word" data-word="at" draggable="true">at</span>
                </div>
                <input type="hidden" name="q21_order" id="q21_order" value="">
                <div id="result21" class="result-container hidden-initial"></div>
            </div>

            <div class="question-group">
                <p class="mb-4">22. What's the difference between "might" and "must"?</p>
                <label><input type="radio" name="q22" value="A"> Might = possibility; Must = certainty/deduction</label>
                <label><input type="radio" name="q22" value="B"> They mean the same thing.</label>
                <label><input type="radio" name="q22" value="C"> Might = obligation; Must = permission</label>
                <div id="result22" class="result-container hidden-initial"></div>
            </div>

            <hr class="border-t border-gray-300 my-10">

            <!-- SECCIÓN III: CONECTORES DE CONTRASTE Y VOZ PASIVA - 12 PREGUNTAS -->
            <h2 class="titulo2 my-6 mt-10">Sección III: Conectores y voz pasiva</h2>

            <p class="subtitulo mb-6">C. However, though, although, even though.</p>

            <div class="question-group">
                <p class="mb-4">23. ______ it was raining, we went for a walk.</p>
                <label><input type="radio" name="q23" value="A"> Although</label>
                <label><input type="radio" name="q23" value="B"> Despite</label>
                <label><input type="radio" name="q23" value="C"> However</label>
                <div id="result23" class="result-container hidden-initial"></div>
            </div>

            <div class="question-group">
                <p class="mb-4">24. He's very busy; ______, he always finds time for his family.</p>
                <label><input type="radio" name="q24" value="A"> although</label>
                <label><input type="radio" name="q24" value="B"> however</label>
                <label><input type="radio" name="q24" value="C"> even though</label>
                <div id="result24" class="result-container hidden-initial"></div>
            </div>

            <!-- Q25: DROP-DOWN -->
            <div class="question-group">
                <p class="mb-4">25. She passed the exam ______ she didn't study much.</p>
                <select name="q25" class="select-dropdown">
                    <option value="" selected disabled>-- Seleccionar conector --</option>
                    <option value="A">however</option>
                    <option value="B">even though</option>
                    <option value="C">despite</option>
                </select>
                <div id="result25" class="result-container hidden-initial"></div>
            </div>

            <p class="subtitulo mb-6 mt-8">D. Voz Pasiva (presente y pasado simple).</p>

            <div class="question-group">
                <p class="mb-4">26. The Mona Lisa ______ (paint) by Leonardo da Vinci.</p>
                <label><input type="radio" name="q26" value="A"> was painted</label>
                <label><input type="radio" name="q26" value="B"> painted</label>
                <label><input type="radio" name="q26" value="C"> is painted</label>
                <div id="result26" class="result-container hidden-initial"></div>
            </div>

            <div class="question-group">
                <p class="mb-4">27. English ______ (speak) all over the world.</p>
                <label><input type="radio" name="q27" value="A"> is speak</label>
                <label><input type="radio" name="q27" value="B"> was spoken</label>
                <label><input type="radio" name="q27" value="C"> is spoken</label>
                <div id="result27" class="result-container hidden-initial"></div>
            </div>

            <div class="question-group">
                <p class="mb-4">28. The emails ______ (send) yesterday morning.</p>
                <label><input type="radio" name="q28" value="A"> were sent</label>
                <label><input type="radio" name="q28" value="B"> are sent</label>
                <label><input type="radio" name="q28" value="C"> sent</label>
                <div id="result28" class="result-container hidden-initial"></div>
            </div>

            <!-- Q29: ORDENAMIENTO (PASIVA) -->
            <div class="question-group">
                <p class="mb-4">29. Ordena las palabras para formar una oración en voz pasiva:</p>
                <div id="q29-words" class="order-container">
                    <span class="order-word" data-word="by" draggable="true">by</span>
                    <span class="order-word" data-word="was" draggable="true">was</span>
                    <span class="order-word" data-word="Shakespeare" draggable="true">Shakespeare</span>
                    <span class="order-word" data-word="Hamlet" draggable="true">Hamlet</span>
                    <span class="order-word" data-word="written" draggable="true">written</span>
                </div>
                <input type="hidden" name="q29_order" id="q29_order" value="">
                <div id="result29" class="result-container hidden-initial"></div>
            </div>

            <!-- Q30: FILL-IN-THE-BLANK DRAG-AND-DROP (PASIVA) -->
            <div class="question-group">
                <p class="mb-4">30. Arrastra la forma correcta del verbo:</p>
                <p class="mb-4">These products 
                    <span id="q30-blank-1" class="drop-blank" data-blank-index="1" data-answer=""></span> 
                    in China.
                </p>
                <div id="q30-pool" class="drag-pool">
                    <span class="order-word" data-word="are made" draggable="true">are made</span>
                    <span class="order-word" data-word="make" draggable="true">make</span>
                    <span class="order-word" data-word="have been made" draggable="true">have been made</span>
                </div>
                <input type="hidden" name="q30_order" id="q30_order" value="">
                <div id="result30" class="result-container hidden-initial"></div>
            </div>

            <div class="question-group">
                <p class="mb-4">31. The new policy ______ (announce) by the CEO last week.</p>
                <label><input type="radio" name="q31" value="A"> announced</label>
                <label><input type="radio" name="q31" value="B"> was announced</label>
                <label><input type="radio" name="q31" value="C"> is announced</label>
                <div id="result31" class="result-container hidden-initial"></div>
            </div>

            <div class="question-group">
                <p class="mb-4">32. Rice ______ (grow) in many countries.</p>
                <label><input type="radio" name="q32" value="A"> grows</label>
                <label><input type="radio" name="q32" value="B"> is grown</label>
                <label><input type="radio" name="q32" value="C"> was grown</label>
                <div id="result32" class="result-container hidden-initial"></div>
            </div>

            <div class="question-group">
                <p class="mb-4">33. The meeting ______ (hold) in the conference room yesterday.</p>
                <label><input type="radio" name="q33" value="A"> held</label>
                <label><input type="radio" name="q33" value="B"> is held</label>
                <label><input type="radio" name="q33" value="C"> was held</label>
                <div id="result33" class="result-container hidden-initial"></div>
            </div>

            <div class="question-group">
                <p class="mb-4">34. Which sentence is in passive voice?</p>
                <label><input type="radio" name="q34" value="A"> A delicious meal was cooked by the chef.</label>
                <label><input type="radio" name="q34" value="B"> The chef cooked a delicious meal.</label>
                <label><input type="radio" name="q34" value="C"> The chef is cooking a delicious meal.</label>
                <div id="result34" class="result-container hidden-initial"></div>
            </div>

            <hr class="border-t border-gray-300 my-10">

            <!-- SECCIÓN IV: PRESENTE PERFECTO CONTINUO - 6 PREGUNTAS -->
            <h2 class="titulo2 my-6 mt-10">Sección IV: Presente perfecto continuo</h2>

            <div class="question-group">
                <p class="mb-4">35. She ______ (work) here for five years.</p>
                <label><input type="radio" name="q35" value="A"> has worked</label>
                <label><input type="radio" name="q35" value="B"> has been working</label>
                <label><input type="radio" name="q35" value="C"> is working</label>
                <div id="result35" class="result-container hidden-initial"></div>
            </div>

            <div class="question-group">
                <p class="mb-4">36. I'm tired because I ______ (run).</p>
                <label><input type="radio" name="q36" value="A"> have been running</label>
                <label><input type="radio" name="q36" value="B"> have run</label>
                <label><input type="radio" name="q36" value="C"> ran</label>
                <div id="result36" class="result-container hidden-initial"></div>
            </div>

            <!-- Q37: DROP-DOWN -->
            <div class="question-group">
                <p class="mb-4">37. How long ______ (you / wait) for the bus?</p>
                <select name="q37" class="select-dropdown">
                    <option value="" selected disabled>-- Seleccionar conjugación --</option>
                    <option value="A">have you been waiting</option>
                    <option value="B">have you waited</option>
                    <option value="C">did you wait</option>
                </select>
                <div id="result37" class="result-container hidden-initial"></div>
            </div>

            <div class="question-group">
                <p class="mb-4">38. They ______ (travel) all day, so they're exhausted.</p>
                <label><input type="radio" name="q38" value="A"> traveled</label>
                <label><input type="radio" name="q38" value="B"> have been traveling</label>
                <label><input type="radio" name="q38" value="C"> have traveled</label>
                <div id="result38" class="result-container hidden-initial"></div>
            </div>

                        <!-- Q39: OPCIÓN MÚLTIPLE (reemplaza drag and drop) -->
            <div class="question-group">
                <p class="mb-4">39. We ______ for this moment our whole lives.</p>
                <label><input type="radio" name="q39" value="A"> have been waiting</label>
                <label><input type="radio" name="q39" value="B"> have waited</label>
                <label><input type="radio" name="q39" value="C"> are waiting</label>
                <div id="result39" class="result-container hidden-initial"></div>
            </div>

            <div class="question-group">
                <p class="mb-4">40. When do we use present perfect continuous?</p>
                <label><input type="radio" name="q40" value="A"> To emphasize the result of a completed action.</label>
                <label><input type="radio" name="q40" value="B"> To emphasize the duration or ongoing nature of an action.</label>
                <label><input type="radio" name="q40" value="C"> To talk about a finished action at a specific time.</label>
                <div id="result40" class="result-container hidden-initial"></div>
            </div>

            <hr class="border-t border-gray-300 my-10">

            <!-- SECCIÓN V: RELATIVE CLAUSES Y REPORTED SPEECH - 6 PREGUNTAS -->
            <h2 class="titulo2 my-6 mt-10">Sección V: Relative clauses y reported speech</h2>

            <p class="subtitulo mb-6">E. Relative clauses (who, which, that).</p>

            <div class="question-group">
                <p class="mb-4">41. The woman ______ lives next door is a doctor.</p>
                <label><input type="radio" name="q41" value="A"> who</label>
                <label><input type="radio" name="q41" value="B"> which</label>
                <label><input type="radio" name="q41" value="C"> where</label>
                <div id="result41" class="result-container hidden-initial"></div>
            </div>

            <div class="question-group">
                <p class="mb-4">42. The car ______ I bought last year is very reliable.</p>
                <label><input type="radio" name="q42" value="A"> where</label>
                <label><input type="radio" name="q42" value="B"> which</label>
                <label><input type="radio" name="q42" value="C"> who</label>
                <div id="result42" class="result-container hidden-initial"></div>
            </div>

            <!-- Q43: DROP-DOWN -->
            <div class="question-group">
                <p class="mb-4">43. That's the restaurant ______ we had our first date.</p>
                <select name="q43" class="select-dropdown">
                    <option value="" selected disabled>-- Seleccionar relativo --</option>
                    <option value="A">which</option>
                    <option value="B">who</option>
                    <option value="C">where</option>
                </select>
                <div id="result43" class="result-container hidden-initial"></div>
            </div>

            <p class="subtitulo mb-6 mt-8">F. Reported Speech.</p>

            <div class="question-group">
                <p class="mb-4">44. Direct speech: "I am tired." <br> Reported speech: He said that he ______ tired.</p>
                <label><input type="radio" name="q44" value="A"> was</label>
                <label><input type="radio" name="q44" value="B"> is</label>
                <label><input type="radio" name="q44" value="C"> has been</label>
                <div id="result44" class="result-container hidden-initial"></div>
            </div>

            <div class="question-group">
                <p class="mb-4">45. Direct speech: "I will call you." <br> Reported speech: She said that she ______ call me.</p>
                <label><input type="radio" name="q45" value="A"> will</label>
                <label><input type="radio" name="q45" value="B"> would</label>
                <label><input type="radio" name="q45" value="C"> can</label>
                <div id="result45" class="result-container hidden-initial"></div>
            </div>

            <!-- Pregunta 46: Opción múltiple -->
            <div class="question-group">
                <p class="mb-4">46. Direct speech: "He is busy." <br> Reported speech: He said ______.</p>
                <label><input type="radio" name="q46" value="A"> that he is busy</label>
                <label><input type="radio" name="q46" value="B"> that he was busy</label>
                <label><input type="radio" name="q46" value="C"> that he has been busy</label>
                <div id="result46" class="result-container hidden-initial"></div>
            </div>

            <hr class="border-t border-gray-300 my-10">

            <!-- SECCIÓN VI: VOCABULARIO - 4 PREGUNTAS -->
            <h2 class="titulo2 my-6 mt-10">Sección VI: Vocabulario</h2>

            <div class="question-group">
                <p class="mb-4">47. A person who has no home is a ______.</p>
                <label><input type="radio" name="q47" value="A"> homeless person</label>
                <label><input type="radio" name="q47" value="B"> refugee</label>
                <label><input type="radio" name="q47" value="C"> competitor</label>
                <div id="result47" class="result-container hidden-initial"></div>
            </div>

            <div class="question-group">
                <p class="mb-4">48. The local ______ of greeting involves shaking hands.</p>
                <label><input type="radio" name="q48" value="A"> ancestry</label>
                <label><input type="radio" name="q48" value="B"> heritage</label>
                <label><input type="radio" name="q48" value="C"> custom</label>
                <div id="result48" class="result-container hidden-initial"></div>
            </div>

            <div class="question-group">
                <p class="mb-4">49. A person who starts a business is an ______.</p>
                <label><input type="radio" name="q49" value="A"> employee</label>
                <label><input type="radio" name="q49" value="B"> entrepreneur</label>
                <label><input type="radio" name="q49" value="C"> competitor</label>
                <div id="result49" class="result-container hidden-initial"></div>
            </div>

            <div class="question-group">
                <p class="mb-4">50. Extreme tiredness caused by stress is called ______.</p>
                <label><input type="radio" name="q50" value="A"> grief</label>
                <label><input type="radio" name="q50" value="B"> burnout</label>
                <label><input type="radio" name="q50" value="C"> loneliness</label>
                <div id="result50" class="result-container hidden-initial"></div>
            </div>

            <!-- BOTONES Y SCORE -->
            <div class="mb-20">
                <div class="flex flex-col items-center">
                    <button type="button" class="check-button" id="checkButton" onclick="checkQuiz()">Verificar respuestas</button>
                    <button type="button" class="pdf-button" id="pdfButton" onclick="generatePDF()">Generar PDF de resultados</button>
                </div>
                <h3 id="finalScore"
                    class="hidden p-5 border-2 border-gray-800 bg-gray-100 rounded-lg text-2xl mt-10 font-bold flex flex-col justify-center items-center"
                    style="margin-bottom: 50px; min-height: 100px;">
                </h3>
            </div>
        </form>
    </main>

    <script>
        // --- JAVASCRIPT CON FUNCIONALIDAD COMPLETA ---
        let draggedItem = null;

        function initializeDragAndDrop() {
            document.querySelectorAll('.order-container').forEach(container => {
                container.addEventListener('dragover', handleDragOverContainer);
                container.addEventListener('drop', handleDropSentence);
                container.addEventListener('dragleave', handleDragLeaveContainer);

                Array.from(container.children).forEach(word => {
                    word.addEventListener('dragstart', handleDragStart);
                    word.addEventListener('dragenter', handleDragEnterWord);
                    word.addEventListener('dragend', handleDragEnd);
                });
            });

            document.querySelectorAll('.drag-pool .order-word').forEach(word => {
                word.addEventListener('dragstart', handleDragStart);
            });

            document.querySelectorAll('.drop-blank').forEach(blank => {
                blank.addEventListener('dragover', handleDragOverBlank);
                blank.addEventListener('drop', handleDropBlank);
                blank.addEventListener('dragleave', handleDragLeaveBlank);
                blank.addEventListener('click', handleBlankClick);
            });

            updateOrderingInputs();
        }

        function handleDragStart(event) {
            draggedItem = event.target;
            const word = draggedItem.dataset.word;
            event.dataTransfer.setData('text/plain', word);
            draggedItem.classList.add('dragging');
        }
        function handleDragEnd(event) {
            if (draggedItem) {
                draggedItem.classList.remove('dragging');
                draggedItem.style.opacity = '1';
            }
            draggedItem = null;
        }

        function handleDragOverContainer(event) {
            event.preventDefault();
            event.currentTarget.classList.add('drag-over');
        }
        function handleDragLeaveContainer(event) {
            event.currentTarget.classList.remove('drag-over');
        }
        function handleDragEnterWord(event) {
            event.preventDefault();
            const target = event.target;
            if (target && target.classList.contains('order-word') && target !== draggedItem) {
                const container = target.closest('.order-container');
                const boundingBox = target.getBoundingClientRect();
                const offset = boundingBox.x + (boundingBox.width / 2);

                if (event.clientX < offset) {
                    container.insertBefore(draggedItem, target);
                } else {
                    container.insertBefore(draggedItem, target.nextSibling);
                }
            }
        }
        function handleDropSentence(event) {
            event.preventDefault();
            const container = event.currentTarget;
            container.classList.remove('drag-over');

            if (draggedItem && container.contains(draggedItem.parentElement)) {
                // No hace nada si el dragEnter ya movió el item.
            } else if (draggedItem && draggedItem.parentElement.classList.contains('drag-pool')) {
                 container.appendChild(draggedItem);
            }
            updateOrderingInputs();
        }

        function handleDragOverBlank(event) {
            event.preventDefault();
            event.currentTarget.classList.add('drag-over');
        }
        function handleDragLeaveBlank(event) {
            event.currentTarget.classList.remove('drag-over');
        }

        function handleDropBlank(event) {
            event.preventDefault();
            const blank = event.currentTarget;
            blank.classList.remove('drag-over');

            const droppedWord = event.dataTransfer.getData('text/plain').trim();

            if (droppedWord) {
                blank.textContent = droppedWord;
                blank.dataset.answer = droppedWord;
                blank.classList.add('drop-blank-filled');
                updateOrderingInputs();
            }
        }

        function handleBlankClick(event) {
            const blank = event.currentTarget;
            if (blank.dataset.answer !== "") {
                blank.textContent = '';
                blank.dataset.answer = '';
                blank.classList.remove('drop-blank-filled');
                updateOrderingInputs();
            }
        }

        function updateOrderingInputs() {
            document.querySelectorAll('.order-container').forEach(container => {
                const qId = container.id.split('-')[0];
                const hiddenInput = document.getElementById(qId + '_order');

                if (hiddenInput) {
                    const words = Array.from(container.querySelectorAll('.order-word'));
                    const sequence = words.map(w => w.getAttribute('data-word').toUpperCase().replace(/'/g, '\\\'')).join('-');
                    hiddenInput.value = sequence;
                }
            });

            ['q7', 'q17', 'q30'].forEach(qId => {
                const numBlanks = (qId === 'q7') ? 3 : (qId === 'q17') ? 2 : 1;

                let blanks = [];
                for(let i = 1; i <= numBlanks; i++) {
                    const blankEl = document.getElementById(`${qId}-blank-${i}`);
                    if (blankEl) {
                        blanks.push(blankEl);
                    }
                }

                const hiddenInput = document.getElementById(qId + '_order');

                if (hiddenInput) {
                    const sequence = Array.from(blanks)
                        .map(b => b.dataset.answer ? b.dataset.answer.toUpperCase().replace(/'/g, '\\\'') : '')
                        .join('-');
                    hiddenInput.value = sequence;
                }
            });
        }

        window.onload = initializeDragAndDrop;

        // --- JUSTIFICACIONES ACTUALIZADAS ---
        const justifications = {
            // Sección I (1-10)
            'q1': 'Segundo condicional: If + past simple, would + infinitive.',
            'q2': 'Pregunta en segundo condicional: would + sujeto + infinitivo, if + sujeto + past simple.',
            'q3': 'En segundo condicional, se usa "were" para todos los sujetos (forma subjuntiva).',
            'q4': 'Negativo en segundo condicional: didn\'t have en la condición, would + verbo en el resultado.',
            'q5': 'Segundo condicional: would + verbo en la cláusula principal.',
            'q6': '"If I were you" es una expresión fija en segundo condicional.',
            'q7_order': 'La estructura del segundo condicional es: If + past simple, would + infinitivo. La oración correcta es: "If I had a better job, I would be happier."',
            'q8': 'El segundo condicional describe situaciones imaginarias o improbables en el presente o futuro.',
            'q9_order': 'Pregunta en segundo condicional: "What would you do if you were president?"',
            'q10': '"If I were you" requiere "wouldn\'t" en la cláusula principal.',
            
            // Sección II (11-22)
            'q11': '"Might" expresa posibilidad.',
            'q12': '"Ought to" es equivalente a "should" pero siempre va seguido de "to".',
            'q13': '"Must" se usa para deducciones lógicas con evidencia.',
            'q14': '"Could" expresa posibilidad.',
            'q15': '"Would rather" va seguido de infinitivo sin "to" y expresa preferencia.',
            'q16': '"Had better" expresa una fuerte recomendación o advertencia.',
            'q17_order': '"Prefer" va seguido de "to" (prefer coffee to tea).',
            'q18': '"Prefer" va seguido de "to" cuando se compara (prefer X to Y).',
            'q19': '"Had better" expresa una fuerte recomendación.',
            'q20': '"Might" expresa posibilidad.',
            'q21_order': '"Would rather" va seguido de infinitivo sin "to": "I would rather cook dinner at home."',
            'q22': '"Might" expresa posibilidad; "must" expresa certeza o deducción.',
            
            // Sección III (23-34)
            'q23': '"Although" introduce una cláusula de contraste.',
            'q24': '"However" se usa para conectar ideas contrastantes, normalmente seguido de coma.',
            'q25': '"Even though" introduce una cláusula de contraste y es más enfático que "although".',
            'q26': 'Voz pasiva en pasado simple: was/were + past participle.',
            'q27': 'Voz pasiva en presente simple: am/is/are + past participle.',
            'q28': 'Voz pasiva en pasado simple con sujeto plural: were + past participle.',
            'q29_order': 'Voz pasiva: objeto + was/were + past participle + by + agente. La oración correcta es: "Hamlet was written by Shakespeare."',
            'q30_order': 'Voz pasiva en presente simple: are + past participle.',
            'q31': 'Voz pasiva en pasado simple con sujeto singular: was + past participle.',
            'q32': 'Voz pasiva en presente simple: is + past participle.',
            'q33': 'Voz pasiva en pasado simple con sujeto singular: was + past participle.',
            'q34': 'La voz pasiva enfatiza la acción o el objeto, no el sujeto que la realiza.',
            
            // Sección IV (35-40)
            'q35': 'Presente perfecto continuo para acciones que empezaron en el pasado y continúan.',
            'q36': 'Presente perfecto continuo para enfatizar el resultado o efecto en el presente.',
            'q37': 'Pregunta en presente perfecto continuo: have/has + sujeto + been + verbo-ing.',
            'q38': 'Presente perfecto continuo para enfatizar la duración de la acción.',
            'q39': 'Presente perfecto continuo: have/has + been + verbo-ing. Se usa "have been waiting" porque enfatiza la duración de la espera.',
            'q40': 'El presente perfecto continuo enfatiza la duración o el proceso de la acción.',
            
            // Sección V (41-46)
            'q41': '"Who" se usa para personas.',
            'q42': '"Which" se usa para cosas.',
            'q43': '"Where" se usa para lugares.',
            'q44': 'En reported speech, el presente simple ("am") cambia a pasado simple ("was").',
            'q45': 'En reported speech, "will" cambia a "would".',
            'q46': 'En reported speech, el presente simple ("is") cambia a pasado simple ("was"). La forma correcta es: "He said that he was busy."',
            
            // Sección VI (47-50)
            'q47': '"Homeless person" significa persona sin hogar.',
            'q48': '"Custom" significa costumbre.',
            'q49': '"Entrepreneur" significa emprendedor.',
            'q50': '"Burnout" significa agotamiento por estrés.'
        };

        function getExplicitAnswerText(qName, correctValue) {
            const qNumberMatch = qName.match(/\d+/);
            const qNumber = qNumberMatch ? qNumberMatch[0] : null;

            if (!qName.endsWith('_order')) {
                const correctInput = document.querySelector(`input[name="q${qNumber}"][value="${correctValue}"]`);
                if (correctInput && correctInput.parentNode) {
                    const label = correctInput.parentNode;
                    let answerText = '';
                    for (let node of label.childNodes) {
                        if (node.nodeType === 3 && node.textContent.trim().length > 0) {
                            answerText += node.textContent;
                        }
                    }
                    const trimmedAnswer = answerText.trim();
                    return trimmedAnswer ? trimmedAnswer.toUpperCase() : correctValue.toUpperCase();
                }

                const selectElement = document.querySelector(`select[name="q${qNumber}"]`);
                if (selectElement) {
                    const correctOption = selectElement.querySelector(`option[value="${correctValue}"]`);
                    if (correctOption) {
                        return correctOption.textContent.toUpperCase();
                    }
                }
            }

            if (qName.endsWith('_order')) {
                if (['q7_order', 'q17_order', 'q29_order', 'q30_order'].includes(qName)) {
                    const fullSentence = correctValue.toUpperCase().replace(/-/g, ' ').replace(/\\'/g, '\'');
                    return fullSentence;
                }
                return justifications[qName].toUpperCase().replace(/-/g, ' ').replace(/\\'/g, '\'');
            }
            return correctValue.toUpperCase();
        }

        function checkQuiz() {
            updateOrderingInputs();

            const totalQuestions = 50;
            const correctAnswers = {
                // Sección I (1-10) - 3 A, 3 B, 3 C, 1 orden
                'q1': 'C', 'q2': 'B', 'q3': 'B', 'q4': 'A', 'q5': 'C',
                'q6': 'B', 'q7_order': 'IF-HAD-WOULD', 'q8': 'A',
                'q9_order': 'WHAT-WOULD-YOU-DO-IF-YOU-WERE-PRESIDENT-?',
                'q10': 'A',
                
                // Sección II (11-22) - 4 A, 3 B, 3 C, 2 orden
                'q11': 'B', 'q12': 'C', 'q13': 'A', 'q14': 'B', 'q15': 'B',
                'q16': 'C', 'q17_order': 'PREFER-TO', 'q18': 'A', 'q19': 'B',
                'q20': 'B', 'q21_order': 'I-WOULD-RATHER-COOK-DINNER-AT-HOME', 'q22': 'A',
                
                // Sección III (23-34) - 3 A, 3 B, 3 C, 2 orden/drag
                'q23': 'A', 'q24': 'B', 'q25': 'B', 'q26': 'A', 'q27': 'C',
                'q28': 'A', 'q29_order': 'HAMLET-WAS-WRITTEN-BY-SHAKESPEARE',
                'q30_order': 'ARE MADE', 'q31': 'B', 'q32': 'B', 'q33': 'C', 'q34': 'A',
                
                // Sección IV (35-40) - 2 A, 2 B, 1 C, 1 orden
                'q35': 'B', 'q36': 'A', 'q37': 'A', 'q38': 'B',
                'q39': 'A', 'q40': 'B',
                
                // Sección V (41-46) - 2 A, 2 B, 2 C
                'q41': 'A', 'q42': 'B', 'q43': 'C', 'q44': 'A', 'q45': 'B', 'q46': 'B',
                
                // Sección VI (47-50) - 2 A, 1 B, 1 C
                'q47': 'A', 'q48': 'C', 'q49': 'B', 'q50': 'B'
            };

            let score = 0;
            let questionKeys = Object.keys(correctAnswers);

            for (let i = 0; i < questionKeys.length; i++) {
                const qKey = questionKeys[i];
                const qNumber = parseInt(qKey.match(/\d+/)[0]);

                const resultDiv = document.getElementById('result' + qNumber);
                const correctAnswerValue = correctAnswers[qKey];

                let answer = null;
                let justificationText = '';

                if (qKey.endsWith('_order')) {
                    const hiddenInput = document.getElementById(qKey);
                    answer = hiddenInput ? hiddenInput.value : null;
                    justificationText = justifications[qKey].replace(/\\'/g, '\'');
                } else {
                    const qName = 'q' + qNumber;
                    const selectEl = document.querySelector(`select[name="${qName}"]`);

                    if (selectEl) {
                        answer = selectEl.value;
                    } else {
                        const radioChecked = document.querySelector(`input[name="${qName}"]:checked`);
                        answer = radioChecked ? radioChecked.value : null;
                    }
                    const generalQKey = qKey;
                    justificationText = justifications[generalQKey] || 'Sin justificación disponible.';
                }

                if (resultDiv) {
                    resultDiv.classList.remove('correct', 'incorrect', 'hidden-initial');
                    resultDiv.textContent = '';
                }

                const displayAnswerText = getExplicitAnswerText(qKey, correctAnswerValue);

                if (answer && answer !== "") {
                    const isCorrect = (answer === correctAnswerValue);

                    if (isCorrect) {
                        score++;
                        if (resultDiv) {
                            resultDiv.textContent = '¡Correcto!';
                            resultDiv.classList.add('correct');
                        }
                    } else {
                        if (resultDiv) {
                            if (qKey.endsWith('_order')) {
                                const yourAnswer = answer.replace(/-/g, ' ').replace(/\\'/g, '\'');
                                resultDiv.innerHTML = `Incorrecto. Tu respuesta fue: <em>${yourAnswer}</em>.<br>La respuesta correcta es: ${displayAnswerText}.<br>Justificación: ${justificationText}`;
                            } else {
                                resultDiv.innerHTML = `Incorrecto. La respuesta correcta es: ${displayAnswerText}.<br>Justificación: ${justificationText}`;
                            }
                            resultDiv.classList.add('incorrect');
                        }
                    }
                } else {
                    if (resultDiv) {
                        resultDiv.innerHTML = `Sin responder. La respuesta correcta es: ${displayAnswerText}.<br>Justificación: ${justificationText}`;
                        resultDiv.classList.add('incorrect');
                    }
                }
            }

            const grade = (score / totalQuestions) * 10;
            const aciertosMessage = `Aciertos: ${score} de ${totalQuestions}`;
            const gradeMessage = `${grade.toFixed(1)}`;

            const finalScoreElement = document.getElementById('finalScore');
            finalScoreElement.innerHTML = `
                <p class="text-xl font-semibold text-gray-800">${aciertosMessage}</p>
                <p class="text-3xl mt-2 font-extrabold text-gray-900">Calificación: ${gradeMessage}</p>
            `;
            finalScoreElement.classList.remove('hidden');
            document.getElementById('pdfButton').style.display = 'block';
            finalScoreElement.scrollIntoView({ behavior: 'smooth' });
        }

        function generatePDF() {
            document.getElementById('finalScore').classList.remove('hidden');
            document.getElementById('checkButton').style.display = 'none';
            document.getElementById('pdfButton').style.display = 'none';
            window.print();
            document.getElementById('checkButton').style.display = 'block';
            document.getElementById('pdfButton').style.display = 'block';
        }
    </script>
</body>
</html>